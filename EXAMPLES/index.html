
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Async wrapper in python for the spotify api" name="description"/>
<link href="https://huiibuh.github.io/AsyncSpotify/EXAMPLES/" rel="canonical"/>
<link href="https://upload.wikimedia.org/wikipedia/commons/9/9b/Font_Awesome_5_brands_spotify.svg" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-5.5.5" name="generator"/>
<title>Examples - Async Spotify</title>
<link href="../assets/stylesheets/main.63b94e9e.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.7f672a1f.min.css" rel="stylesheet"/>
<meta content="#4caf50" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../custom.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="" data-md-color-primary="green" data-md-color-scheme="preference" dir="ltr">
<script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#examples">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Async Spotify" class="md-header-nav__button md-logo" href="https://huiibuh.github.io/AsyncSpotify/" title="Async Spotify">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.9 10.9C14.7 9 9.35 8.8 6.3 9.75c-.5.15-1-.15-1.15-.6-.15-.5.15-1 .6-1.15 3.55-1.05 9.4-.85 13.1 1.35.45.25.6.85.35 1.3-.25.35-.85.5-1.3.25m-.1 2.8c-.25.35-.7.5-1.05.25-2.7-1.65-6.8-2.15-9.95-1.15-.4.1-.85-.1-.95-.5-.1-.4.1-.85.5-.95 3.65-1.1 8.15-.55 11.25 1.35.3.15.45.65.2 1m-1.2 2.75c-.2.3-.55.4-.85.2-2.35-1.45-5.3-1.75-8.8-.95-.35.1-.65-.15-.75-.45-.1-.35.15-.65.45-.75 3.8-.85 7.1-.5 9.7 1.1.35.15.4.55.25.85M12 2A10 10 0 002 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            Async Spotify
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Examples
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/HuiiBuh/AsyncSpotify/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M2.6 10.59L8.38 4.8l1.69 1.7c-.24.85.15 1.78.93 2.23v5.54c-.6.34-1 .99-1 1.73a2 2 0 002 2 2 2 0 002-2c0-.74-.4-1.39-1-1.73V9.41l2.07 2.09c-.07.15-.07.32-.07.5a2 2 0 002 2 2 2 0 002-2 2 2 0 00-2-2c-.18 0-.35 0-.5.07L13.93 7.5a1.98 1.98 0 00-1.15-2.34c-.43-.16-.88-.2-1.28-.09L9.8 3.38l.79-.78c.78-.79 2.04-.79 2.82 0l7.99 7.99c.79.78.79 2.04 0 2.82l-7.99 7.99c-.78.79-2.04.79-2.82 0L2.6 13.41c-.79-.78-.79-2.04 0-2.82z"></path></svg>
</div>
<div class="md-source__repository">
    HuiiBuh/AsyncSpotify
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Async Spotify" class="md-nav__button md-logo" href="https://huiibuh.github.io/AsyncSpotify/" title="Async Spotify">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.9 10.9C14.7 9 9.35 8.8 6.3 9.75c-.5.15-1-.15-1.15-.6-.15-.5.15-1 .6-1.15 3.55-1.05 9.4-.85 13.1 1.35.45.25.6.85.35 1.3-.25.35-.85.5-1.3.25m-.1 2.8c-.25.35-.7.5-1.05.25-2.7-1.65-6.8-2.15-9.95-1.15-.4.1-.85-.1-.95-.5-.1-.4.1-.85.5-.95 3.65-1.1 8.15-.55 11.25 1.35.3.15.45.65.2 1m-1.2 2.75c-.2.3-.55.4-.85.2-2.35-1.45-5.3-1.75-8.8-.95-.35.1-.65-.15-.75-.45-.1-.35.15-.65.45-.75 3.8-.85 7.1-.5 9.7 1.1.35.15.4.55.25.85M12 2A10 10 0 002 12a10 10 0 0010 10 10 10 0 0010-10A10 10 0 0012 2z"></path></svg>
</a>
    Async Spotify
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/HuiiBuh/AsyncSpotify/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M2.6 10.59L8.38 4.8l1.69 1.7c-.24.85.15 1.78.93 2.23v5.54c-.6.34-1 .99-1 1.73a2 2 0 002 2 2 2 0 002-2c0-.74-.4-1.39-1-1.73V9.41l2.07 2.09c-.07.15-.07.32-.07.5a2 2 0 002 2 2 2 0 002-2 2 2 0 00-2-2c-.18 0-.35 0-.5.07L13.93 7.5a1.98 1.98 0 00-1.15-2.34c-.43-.16-.88-.2-1.28-.09L9.8 3.38l.79-.78c.78-.79 2.04-.79 2.82 0l7.99 7.99c.79.78.79 2.04 0 2.82l-7.99 7.99c-.78.79-2.04.79-2.82 0L2.6 13.41c-.79-.78-.79-2.04 0-2.82z"></path></svg>
</div>
<div class="md-source__repository">
    HuiiBuh/AsyncSpotify
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Examples
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Examples">
      Examples
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">
    Getting started
  </a>
<nav aria-label="Getting started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#authorization-code-flow">
    Authorization Code Flow
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#client-credentials-flow">
    Client Credentials Flow
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#endpoints">
    Endpoints
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-configuration">
    Advanced Configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exceptions">
    Exceptions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#code-retrieval-with-a-cookie">
    Code retrieval with a cookie
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#token-expiration-hook">
    Token expiration hook
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Public API
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Public API" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Public API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/spotify_api_client/" title="Spotify Api Client">
      Spotify Api Client
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/authentification/" title="Authentification">
      Authentification
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/spotify_errors/" title="Spotify Errors">
      Spotify Errors
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/token_renew_class/" title="Token Renew Hook">
      Token Renew Hook
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" id="nav-3-5" type="checkbox"/>
<label class="md-nav__link" for="nav-3-5">
      Endpoints
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Endpoints" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="nav-3-5">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Endpoints
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/overview/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/albums/" title="Albums">
      Albums
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/artists/" title="Artists">
      Artists
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/browse/" title="Browse">
      Browse
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/episodes/" title="Episodes">
      Episodes
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/follow/" title="Follow">
      Follow
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/library/" title="Library">
      Library
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/personalization/" title="Personalization">
      Personalization
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/player/" title="Player">
      Player
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/playlists/" title="Playlists">
      Playlists
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/search/" title="Search">
      Search
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/shows/" title="Shows">
      Shows
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/tracks/" title="Tracks">
      Tracks
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../public_api/endpoints/user/" title="User">
      User
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Private API
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Private API" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-4">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Private API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../private_api/error_message/" title="Error Message">
      Error Message
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../private_api/request_handler/" title="Request Handler">
      Request Handler
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../private_api/status_classes/" title="Status Classes">
      Status Classes
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../private_api/url/" title="URLS">
      URLS
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../STUFF/" title="Tests">
      Tests
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../LICENCE/" title="Licence">
      Licence
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">
    Getting started
  </a>
<nav aria-label="Getting started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#authorization-code-flow">
    Authorization Code Flow
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#client-credentials-flow">
    Client Credentials Flow
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#endpoints">
    Endpoints
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#advanced-configuration">
    Advanced Configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exceptions">
    Exceptions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#code-retrieval-with-a-cookie">
    Code retrieval with a cookie
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#token-expiration-hook">
    Token expiration hook
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/HuiiBuh/AsyncSpotify/edit/master/docs/EXAMPLES.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">¶</a></h1>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">¶</a></h2>
<p>If you want to start connecting to the spotify api you have to create a new instance of one of the AuthorizationCodeFlows. Currently onle the <code>AuthorizationCodeFlow</code> and <code>ClientCredentialsFlow</code> are supported. These AuthorizationCodeFlow hold all sorts of configurations.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">async_spotify.authentification.authorization_flows</span> <span class="kn">import</span> <span class="n">AuthorizationCodeFlow</span>

<span class="n">auth_flow</span> <span class="o">=</span> <span class="n">AuthorizationCodeFlow</span><span class="p">(</span>
    <span class="n">application_id</span> <span class="o">=</span> <span class="s1">'Your id'</span><span class="p">,</span>
    <span class="n">application_secret</span> <span class="o">=</span> <span class="s1">'Your secret'</span><span class="p">,</span>
    <span class="n">scopes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'your'</span><span class="p">,</span> <span class="s1">'scopes'</span><span class="p">],</span>
    <span class="n">redirect_url</span> <span class="o">=</span> <span class="s1">'your.redirect.utl'</span><span class="p">)</span>

<span class="c1"># You can also load the auth_code_flow from environment variables.</span>
<span class="c1"># If the variable does not exist the existing value will not be overwritten.</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>
</code></pre></div>
<p>These created auth_flow have to be passed to the <code>SpotifyApiClient</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create new client</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">)</span>
</code></pre></div>
<h3 id="authorization-code-flow">Authorization Code Flow<a class="headerlink" href="#authorization-code-flow" title="Permanent link">¶</a></h3>
<p>To get a code from Spotify the user has to agree to the scopes your app asks for.<br/>
For this you create an authorization, let the user visit this url and read the code parameter in the spotify redirect.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Build the authorization url for the users</span>
<span class="n">authorization_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">api_client</span><span class="o">.</span><span class="n">build_authorization_url</span><span class="p">(</span><span class="n">show_dialog</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>If you have some questions about this process read <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/#authorization-code-flow">this</a> spotify article about it.</p>
<p>We will assume that you managed to get a code from spotify for a specific user.</p>
<p>Now we have to exchange the code for an authorization token, and a refresh token.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Exchange the code for the tokens</span>
<span class="n">auth_token</span><span class="p">:</span> <span class="n">SpotifyAuthorisationToken</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_auth_token_with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</code></pre></div>
<p>After we recieved the <code>auth_token</code> we can start making request.
But before we make this we have to create a new client which will be internally used for all the request making.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new client which will handle the request</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>

<span class="c1"># Get information about an album</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">,</span> <span class="n">market</span><span class="o">=</span><span class="s1">'DE'</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want to shut down your application and don't want to leak requests you have to call the <code>close_client</code> method of the <code>api_client</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Close the client</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
</div>
<h3 id="client-credentials-flow">Client Credentials Flow<a class="headerlink" href="#client-credentials-flow" title="Permanent link">¶</a></h3>
<p>In this case you only have to pass your auth_flow to your <code>SpotifyApiClient</code> and call the <code>get_auth_token_with_client_credentials</code> method.</p>
<p>If you have some questions about this process read <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/#client-credentials-flow">this</a> potify article about it.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a auth flow (this time a ClientCredentialsFlow)</span>
<span class="n">auth_flow</span> <span class="o">=</span> <span class="n">ClientCredentialsFlow</span><span class="p">()</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>

<span class="c1"># Pass it to the spotify client</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">)</span>

<span class="c1"># Get the token from spotify</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">get_auth_token_with_client_credentials</span><span class="p">()</span>
<span class="c1"># And start making requests</span>
<span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>
</code></pre></div>
<p>After we recieved the <code>auth_token</code> we can start making request.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new client which will handle the request</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">()</span>

<span class="c1"># Get information about an album</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">,</span> <span class="n">market</span><span class="o">=</span><span class="s1">'DE'</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want to shut down your application and don't want to leak requests you have to call the <code>close_client</code> method of the <code>api_client</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Close the client</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
</div>
<h2 id="endpoints">Endpoints<a class="headerlink" href="#endpoints" title="Permanent link">¶</a></h2>
<p>Every Api Endpoint is represented as an instance variables of the <code>SpotifyApiClient</code>.<br/>
Look <a href="https://huiibuh.github.io/AsyncSpotify/public_api/spotify_api_client/">here</a> for every instance variable and the associated classes.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># For the albums endpoint</span>
<span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">whatever</span><span class="p">()</span>
<span class="c1"># For the artist endpoint</span>
<span class="n">api_client</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">whatever</span><span class="p">()</span>
</code></pre></div>
<h2 id="advanced-configuration">Advanced Configuration<a class="headerlink" href="#advanced-configuration" title="Permanent link">¶</a></h2>
<p>If you don't want to pass the <code>auth_token</code> every time you make a request you can instruct the <code>SpotifyApiClient</code> to keep the token in memory.
Every time you refresh the token the in memory token will be updated too.
So you always have a valid token you can make requests with.
If the token expires you will still have to refresh it yourself by calling the <code>refresh_token</code> method, which will returned the updated token.
You don't have to pass a token to the method however if you want the internal token to be updated.<br/>
In addition to that you can limit the simultaneous requests, and the timout if you create a new client.</p>
<div class="highlight"><pre><span></span><code><span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># And if you already have a auth_token you can pass this token to the constructor</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auth_token</span><span class="o">=</span><span class="n">auth_token</span><span class="p">)</span>
<span class="c1"># Make the requests without passing the auth_token every time</span>
<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>

<span class="c1"># Limit the requests and the timeout</span>
<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">create_new_client</span><span class="p">(</span><span class="n">request_limit</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span> <span class="n">request_timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</code></pre></div>
<h2 id="exceptions">Exceptions<a class="headerlink" href="#exceptions" title="Permanent link">¶</a></h2>
<p>There are multiple exception which could get raised by the <code>SpotifyApiClient</code>.<br/>
Every exception inherits from the <code>SpotifyBaseError</code> so if you want to catch every spotify exception you can do it with the <code>SpotifyBaseError</code>.</p>
<ul>
<li>The <code>SpotifyError</code> exception gets raised for general usage errors</li>
<li>The <code>TokenExpired</code> exception gets raised if the spotify token used for making an api call is expired</li>
<li>The <code>RateLimitExceeded</code> exception gets raised if the rate limit is exceeded</li>
<li>The <code>SpotifyAPIError</code> exception gets raised for general errors like a invalid album id</li>
</ul>
<p>Each of the exceptions implements the <code>get_json()</code> method which will return the following json:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"error"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"status"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">"message"</span><span class="p">:</span> <span class="s2">""</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The status is the HTTP status code and if not aplicable the number 0.
The message is the reason something failed.</p>
<div class="highlight"><pre><span></span><code><span class="k">try</span><span class="p">:</span>
    <span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>
<span class="k">except</span> <span class="n">SpotifyAPIError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
    <span class="c1"># Do something with the error message</span>
</code></pre></div>
<h2 id="code-retrieval-with-a-cookie">Code retrieval with a cookie<a class="headerlink" href="#code-retrieval-with-a-cookie" title="Permanent link">¶</a></h2>
<p>Normally you have to get the code with the client credential workflow. If your user has already agreed to the scopes, and you have the cookie of the user you can get rid of this process.<br/>
This is mostly intended for testing purposes, but you could also use it in your production environment in the very unlikely edge case that you have the spotify cookie of your user.</p>
<p>You start like normal and create a new <code>SpotifyApiClient</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">auth_flow</span> <span class="o">=</span> <span class="n">AuthorizationCodeFlow</span><span class="p">()</span>
<span class="n">auth_flow</span><span class="o">.</span><span class="n">load_from_env</span><span class="p">()</span>

<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a new spotify cookie</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="n">SpotifyCookie</span><span class="p">()</span>
<span class="c1"># Load the cookie from a file (you can also use the constructor to pass the data)</span>
<span class="n">cookies</span><span class="o">.</span><span class="n">load_from_file</span><span class="p">(</span><span class="s1">'Path/to/cookie.json'</span><span class="p">)</span>

<span class="c1"># Get the coke with the spotify cookie</span>
<span class="n">code</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_code_with_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>

<span class="c1"># Use the retrieved code to get the auth token</span>
<span class="n">auth_token</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api</span><span class="o">.</span><span class="n">get_auth_token_with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

<span class="n">album</span> <span class="o">=</span> <span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">albums</span><span class="o">.</span><span class="n">get_one</span><span class="p">(</span><span class="n">album_id</span><span class="p">)</span>

<span class="k">await</span> <span class="n">api_client</span><span class="o">.</span><span class="n">close_client</span><span class="p">()</span>
</code></pre></div>
<p>Format of the <em>cookie.json</em></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
  <span class="nt">"sp_t"</span><span class="p">:</span> <span class="s2">"a"</span><span class="p">,</span>
  <span class="nt">"sp_dc"</span><span class="p">:</span> <span class="s2">"b"</span><span class="p">,</span>
  <span class="nt">"sp_key"</span><span class="p">:</span> <span class="s2">"c"</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="token-expiration-hook">Token expiration hook<a class="headerlink" href="#token-expiration-hook" title="Permanent link">¶</a></h2>
<p>If you want to add a hook in case your auth token expires you can pass an instance of your <code>TokenRenewClass</code> to the <code>SpotifyApiClient</code>.<br/>
Your <code>TokenRenewClass</code> has to implement an <code>async call</code> method which has the <code>SpotifyApiClient</code> as parameter and returns an updated and valid <code>SpotifyAuthorisationToken</code>.
As long as you respect this interface you can do what you want (update a token in your database, ...).</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">YourTokenRenewClass</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Renew the auth token every time it expires</span>
<span class="sd">    """</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spotify_api_client</span><span class="p">:</span> <span class="n">SpotifyApiClient</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpotifyAuthorisationToken</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Async method which gets called if the token is expired</span>

<span class="sd">        Args:</span>
<span class="sd">            spotify_api_client: The instance of the SpotifyApiClient</span>

<span class="sd">        Returns: A renewed spotify authorization token</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="k">await</span> <span class="n">spotify_api_client</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">()</span>

<span class="n">renew_class</span> <span class="o">=</span> <span class="n">YourTokenRenewClass</span><span class="p">()</span>

<span class="n">api_client</span> <span class="o">=</span> <span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">token_renew_instance</span> <span class="o">=</span> <span class="n">renew_class</span><span class="p">)</span>
<span class="c1"># ...</span>
</code></pre></div>
<p>If you don't want to implement a class for your own and don't want to save the updated auth token to your database you can use the included <a href="../public_api/token_renew_class/"><code>TokenRenewClass</code></a>.<br/>
Because <code>hold_authentication</code> is set to <code>True</code> the SpotifyApiClient will save the renewed token in memory and use it to make request.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">async_spotify</span> <span class="kn">import</span> <span class="n">SpotifyApiClient</span><span class="p">,</span> <span class="n">TokenRenewClass</span>

<span class="n">renew_token</span> <span class="o">=</span> <span class="n">TokenRenewClass</span><span class="p">()</span>
<span class="n">SpotifyApiClient</span><span class="p">(</span><span class="n">auth_flow</span><span class="p">,</span> <span class="n">hold_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">renew_token</span><span class="p">)</span>
</code></pre></div>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 20, 2020</span>
</small>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href=".." rel="prev" title="Overview">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../public_api/spotify_api_client/" rel="next" title="Spotify Api Client">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Spotify Api Client
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/huiibuh" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.d1f5a259.min.js"></script>
<script src="../assets/javascripts/bundle.f9edbbd5.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>